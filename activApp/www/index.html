<!DOCTYPE html>
<!--HTML5 doctype-->
<html>

<head>

    <title>activApp</title>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0, minimal-ui">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <META HTTP-EQUIV="Pragma" CONTENT="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="stylesheet" type="text/css" href="lib/appframework/icons.css" />
    <link rel="stylesheet" type="text/css" href="lib/appframework/af.ui.css" />

    <script type="text/javascript" charset="utf-8" src="lib/jquery.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="lib/fastclick.min.js"></script>
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
    <script type="text/javascript" charset="utf-8" src="lib/appframework/appframework.ui.min.js"></script>
        
    <script src='cordova.js'></script>

    <script>

        $(document).ready(function(){

            $("#main").bind("panelbeforeload", startApp);
            // setup signin and signup button events
            $("#login").on("click", function(){
                signIn();
            });

            $("#register").on("click", function(){
                signUp();
            });
            
            $("#public").on("click", function(){
                
            });
            
            stayOn();

        });

        function signIn(){


            // SIGNIN SERVER CALL CODE GOES HERE

            valid_login = false;

            $.afui.loadContent("#main", null, null, "fade");
            /*if(valid_login){
                $.afui.loadContent("#main", null, null, "fade");
            }
            else
            {
                //Example use of the error toast api
                var opts={
                    message:"Invalid Login Combination",
                    position:"tc",
                    delay:2000,
                    autoClose:true,
                    type:"error"
                };
                $.afui.toast(opts);
            }*/
        }

        function signUp(){

            //example client side validation
            if ($("#password").val() === $("#confirmpassword").val())
            {
                // SIGNUP SERVER CALL CODE GOES HERE

                //render main view
                $.afui.loadContent("#main", null, null, "fade");

                //Example use of the success toast
                var opts={
                    message:"Account Created",
                    position:"tc",
                    delay:2000,
                    autoClose:true,
                    type:"success"
                };
                $.afui.toast(opts);

            }
            else
            {
                //Example use of the error toast
                var opts={
                    message:"Passwords Don't Match",
                    position:"tc",
                    delay:2000,
                    autoClose:true,
                    type:"error"
                };
                $.afui.toast(opts);
            }


        }
        
        function addMarker(location, map, title) {
            var marker = new google.maps.Marker({
                position: location,
                map: map,
                title: title
              });
        }
        
        function success(position) {
              var mapcanvas = document.createElement('div');
              mapcanvas.id = 'mapcanvas';
              mapcanvas.style.height = '1024px';
              mapcanvas.style.width = '100%';

              document.querySelector('article').appendChild(mapcanvas);

              var latlng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
            
              var myOptions = {
                zoom: 15,
                center: latlng,
                mapTypeControl: false,
                navigationControlOptions: {style: google.maps.NavigationControlStyle.SMALL},
                mapTypeId: google.maps.MapTypeId.ROADMAP
              };
              var map = new google.maps.Map(document.getElementById("mapcanvas"), myOptions);

              new google.maps.Marker({
                  position: latlng, 
                  map: map, 
                  title:"Aquí"
              });   
            
              addMarker(new google.maps.LatLng(-31.4199, -64.1883), map, "Fundación APADEA");    
            }

            function error(msg) {
              var s = document.querySelector('#status');
              s.innerHTML = typeof msg == 'string' ? msg : "failed";
              s.className = 'fail';
            }
        
        function stayOn(){
            if (navigator.geolocation) {
              navigator.geolocation.getCurrentPosition(success, error);
            } else {
              error('No soportado');
            }
        }

        function startApp(){
            // clears all back button history
            $.afui.clearHistory();

            // your app code here
        }

    </script>

</head>

<body>

    <div id="splashscreen" class='ui-loader heavy'>
        <br>
        <br>
        <span class='ui-icon ui-icon-loading spin'></span>
        <h1>activApp</h1>
    </div>

    <div class="view" id="mainview">
        <header>
            <h1>activApp</h1>
        </header>

        <div class="pages">

            <!-- Welcome View -->
            <div class="panel" data-title="activApp" id="page1" data-header="none" data-footer="none" selected="true">
                <div style="text-align:center">
                    <br>
                    <br>
                    <p></p>
                    <br>
                    <br>
                </div>
                <ul class="list inset">
                    <li><a href="#signin" class="icon user" style="text-align:center">Login</a></li>
                    <!--<li><a href="#signup" class="icon pencil" style="text-align:center">Register</a></li>-->
                </ul>
            </div>

            <!-- Login View -->
            <div class="panel" data-title="Login" id="signin" data-footer="none">
                <div style="text-align:center">
                    <br>
                    <br>
                    <p></p>
                    <br>
                    <br>
                </div>
                <a class="button block" href="#" id="login">Login with Facebook</a>
            </div>

            <!-- Register View -->
            <div class="panel" data-title="Register" id="signup" data-footer="none">
                <div style="text-align:center">
                    <br>
                    <br>
                    <p></p>
                    <br>
                    <br>
                </div>
                <input name="name" type="text" placeholder="Name" id="name" />
                <input name="email" type="text" placeholder="Email" id="email" />
                <input name="username" type="text" placeholder="Username" id="username" />
                <input name="password" type="password" placeholder="Password" id="password" />
                <input name="password2" type="password" placeholder="Confirm Password" id="confirmpassword" />
                <a class="button block" href="#" id="register">Register</a>
            </div>

            <!-- Main App View -->
            <div class="panel" data-title="activApp" id="main">
                <article>
                </article>
            </div>
        </div>
    </div>

</body>

</html>